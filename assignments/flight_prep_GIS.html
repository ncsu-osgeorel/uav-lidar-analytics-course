<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>GIS595/MEA792: UAV/lidar Data Analytics</title>

<link rel="shortcut icon" href=".././img/favicon.ico" />

<link href="../layout.css" rel="stylesheet" type="text/css" media="screen">
<link href="../style.css" rel="stylesheet" type="text/css" media="screen">

</head>

<body>

<div id="outercontainer">
<div id="container">

<header>
<div id="header-image">
    <h1>GIS595/MEA792:<br>UAV/lidar Data Analytics</h1>
</div>

<nav>
<ul class="nav">
<li><a href="../index.html">Syllabus</a></li>
<li><a href="../schedule.html">Schedule</a></li>
<li><a href="../lectures.html">Lectures</a></li>
<li><a href="../assignments.html">Assignments</a></li>
<li><a href="../projects.html">Projects</a></li>
</ul>
</nav>

</header>

<main>
<!-- This is a generated file. Do not edit. -->
<div style="background-color: #FA8; border: 4px solid #F00; padding: 10px;"><p>This is an unmaintained course material, please see current material at:<ul><li><a href="https://ncsu-geoforall-lab.github.io/uav-lidar-analytics-course/">https://ncsu-geoforall-lab.github.io/uav-lidar-analytics-course/</a></li><li><a href="https://ncsu-geoforall-lab.github.io/uav-lidar-analytics-course/assignments/flight_prep_GIS.html">https://ncsu-geoforall-lab.github.io/uav-lidar-analytics-course/assignments/flight_prep_GIS.html</a> (likely URL)</li></ul></div>
<h1>Terrain Analysis of the flight site using GIS tools</h1>

<p>In order to execute a safe flight, you need to make sure that the flight path will not cross any
obstacles. Also remember that the ground altitude is measured in the take off localization and
does not take into account local relief. It can be crucial in the mountainous areas. In our case
trees, buildings and other man-made structures are more of a concern.
Because both â€“ terrain data (from lidar) and planned flight path (generated by you in the Trimble
Aerial Imaging software) are available, the the elevation difference between the flight celling and
the surface can be computed using GIS tools.</p>

<h4>
General workflow (with GCPs):</h4>

<ol>
    <li>Compute a raster for elevation of the flight path
    <li>Generate DSM
    <li>Calculate the elevation difference between the flight path and surface
</ol>


<h4>Data</h4>

<ul>
    <li>GRASS Location, see the links for data at the <a href="../assignments.html">Assignments</a> webpage
    <li>2013 lidar data <a href="http://fatra.cnr.ncsu.edu/uav-lidar-analytics-course/secref_spm_2013.las"> SECREF</a> and <a href="http://fatra.cnr.ncsu.edu/uav-lidar-analytics-course/mid_pines_spm_2013.las"> Mid Pines </a>
</ul>
<h4>Software</h4>

<ul>
    <li><a href="http://grass.osgeo.org/">GRASS GIS 7.0.1</a>
    <li>Trimble Aerial Imaging <a href="https://drive.google.com/open?id=0B1AfQGDB8tPXRWo0TGl1a3ZVMDQ">installation file (Windows)</a>
</ul>

<h3>Compute a raster for elevation of the flight path</h3>

For this analysis you can run GRASS GIS with the Lake_Wheeler_NCspm location 
or nc_spm_08 from MEA582 can be used as well. Create a new mapset to manage your flight analysis. <br>
!!! <strong>REMEMBER</strong> !!! to set the directory first or use the whole paths for the input files. All the commands with indication: <i>#customize name#</i> cannot be just copied and pasted into the GRASS command line

<ul>
    <li>Export a flight plan path that you created to the kml file from Trimble Aerial Imaging .gwt project</li>
    <li>Launch GRASS</li>
    <li>install the v.import package
<pre><code>g.extension extension=v.import svnurl=http://svn.osgeo.org/grass/grass-addons/grass7
</code></pre>
    <li>Import generated kml into GRASS
<pre><code><i>#customize name#</i>
v.import input=exported_kml_file.kml output=flight_track_kml
</code></pre>
    <li>Convert vector line to elevation points. Set the maximum distance between the points as 0.3 m
<pre><code>v.to.points -i input=flight_track_kml output=flight_track_points dmax=0.3
</code></pre>
     <li>Convert vector to raster after setting the region to study area and 1m resolution
<pre><code>g.region vect=flight_track_kml res=1
v.to.rast input=flight_track_points output=flight_path_altitude_rast use=z
</code></pre>
     <li>Make the flight path line thick (wide) enough taking to account the wingspan of the UAV and weather impacts on the flight trajectory. Desired width of the path = 5m (radius 2.5m)
<pre><code>r.grow -m input=flight_path_altitude_rast output=flight_path_wide radius=2.5
</code></pre>
</ul>


<h3>Generate DSM </h3>


<ul>
    <li>Download lidar data for <a href="http://fatra.cnr.ncsu.edu/uav-lidar-analytics-course/secref_spm_2013.las"> SECREF</a> and <a href="http://fatra.cnr.ncsu.edu/uav-lidar-analytics-course/mid_pines_spm_2013.las"> Mid Pines </a> to your computer</li>
   <li> set region to your study area using g.region or using the zoom function for setting the region 
    <li>Import lidar data to grass
<pre><code><i>#customize name#</i>
r.in.lidar mid_pines_spm_2013.las output=mid_pines_surface_max method=max class_filter=1,2 return_filter=first resolution=3 -oe 
r.in.lidar secref_spm_2013.las output=secref_surface_max method=max class_filter=1,2 return=first res=3 zrange=0,300 -oe
</code></pre>
 </ul>

<h3>Calculate the elevation difference between the flight path and surface</h3>
<ul>
    <li>Use map algebra to compute difference between two rasters - elevation of your flight path and Surface of the terrain
<pre><code>r.mapcalc expression="elev_diff = flight_path_wide - mid_pines_surface_max"
r.mapcalc expression="elev_diff = flight_path_wide - secref_surface_max"
</code></pre>
</ul>
<p>Use the acquired diffrence map to evaluate your flight plan, pay close attention to the obstacle free zones</p>
<h4>Visualize results</h4>
<p> You can use screenshots from Trimble Aerial Imaging and GRASS. If you discovered any obstacles  and needed to readjust the flight path - include the picture and description of the issue. You can display the orthophoto, COA boundaries for better understanding of the terrain. Orthophoto is in <a href="http://courses.ncsu.edu/mea582/common/media/01/nc_spm_08_grass7.zip"> nc_spm_08_grass7</a> location and COA in <a href="https://drive.google.com/open?id=0B1AfQGDB8tPXfmZPRHlYSTNIZzdpRVBzay04c0VXUjM4Nzlmbjl5WDlrcGs1bFVLczlTd1k"> Lake_Wheeler_NCspm</a> location.
<h4>Explain your choice of the flight area, parameters and takeoff and landing locations based on the performed analysis</h4>
<p> The aim is to prove that the flight plan that you've created can be used to execute a safe and sucessful flight mission. Describe your thought process - what did you take into account first, what problems did you encouter? Did you need to change your initial plans based on software limitations, legal issues or the relief of the targeted area? <br>
Put the results in the short presentation and we will discuss it in the class. You will time to correct it and include the feedback in the report.



</main>

<footer>

<nav>
<ul>
<li>
    <a href="https://github.com/ncsu-osgeorel/uav-lidar-analytics-course" title="Fork on GitHub">
        <img src="../img/github_logo.png" alt="GitHub Octocat logo">
    </a>
</li>
<li title="Copyright and license (not applicable to linked materials)">
    &copy; 2015
    <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
    <a href="http://geospatial.ncsu.edu/osgeorel/">NCSU OSGeoREL</a>
</li>
</ul>
</nav>

</footer>

</div>
</div>

</body>
</html>
